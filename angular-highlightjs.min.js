/*! angular-highlightjs
version: 0.0.1
build date: 2013-07-23
author: Robin Fan
https://github.com/pc035860/angular-highlightjs.git */
angular.module("ngHljs",[]).controller("NgHljsCtrl",["$timeout",function(a){var b=this,c=null;b.init=function(a){c=a},b.highlight=function(b){c&&(c.text(b),a(function(){hljs.highlightBlock(c[0])}))},b.clear=function(){c&&c.text("")},b.release=function(){c=null}}]).directive("ngHljs",[function(){return{restrict:"EA",controller:"NgHljsCtrl",compile:function(a){var b=a[0].innerHTML.replace(/^\r\n|\r|\n/,"");return a.html("<pre><code></code></pre>"),function(a,c,d,e){e.init(c.find("code")),b&&e.highlight(b),a.$on("$destroy",function(){e.release()})}}}}]).directive("source",[function(){return{require:"ngHljs",restrict:"A",link:function(a,b,c,d){a.$watch(c.source,function(a,b){a&&a!==b?d.highlight(a):d.clear()})}}}]).directive("fetch",["$http","$templateCache","$q",function(a,b,c){return{require:"ngHljs",restrict:"A",compile:function(d,e){var f=e.fetch;return function(d,e,g,h){var i=0;d.$watch(f,function(d){var e=++i;if(d&&angular.isString(d)){var f,g;f=b.get(d),f||(g=c.defer(),a.get(d,{cache:b}).success(function(a){e===i&&g.resolve(a)}).error(function(){e===i&&h.clear(),g.resolve()}),f=g.promise),c.when(f).then(function(a){a&&(angular.isArray(a)&&(a=a[1]),a=a.replace(/^\r\n|\r|\n/,""),h.highlight(a))})}else h.clear()})}}}}]);